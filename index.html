<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        
        <!-- Link font awesome 6.0. -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.7.2/font/bootstrap-icons.min.css" integrity="sha512-1fPmaHba3v4A7PaUsComSM4TBsrrRGs+/fv0vrzafQ+Rw+siILTiJa0NtFfvGeyY5E182SDTaF5PqP+XOHgJag==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <style>
            :root {
                --light-color: rgba(36,36,36);
                --darker-color: rgba(27,27,27);
                --darkest-color: rgb(17,17,17);
                overflow-x: hidden;
                }
            html, body {
                color: white;
                user-select: none; /* supported by Chrome and Opera */
                -webkit-user-select: none; /* Safari */
                -khtml-user-select: none; /* Konqueror HTML */
                -moz-user-select: none; /* Firefox */
                -ms-user-select: none; /* Internet Explorer/Edge */
                overflow-x: hidden;

            }
            
            th, td {
                border-top: none !important;
                border-bottom: 1px solid var(--info) !important;
            }

            #header {
                background-color: var(--light-color)
            }
            
            #close-btn {
                position: absolute;
                top: 0;
                right: 15px;
                padding-left: 20px;
                padding-right: 20px;
                padding-top: 0;
                padding-bottom: 0;
                border-radius: 0;
                height:22px;
            }

            .nav {
                height: 525px;
            }

            .nav-icon {
                margin-right: 20px;
                color: white;
                font-size:22px;
            }

            .nav-link {
                white-space: nowrap;
                font-size: 1.5vw;
                color: white;
            }

            .nav-link:hover {
                color: #ffc107;
                background-color: rgba(27, 27,27, 0.7);
            }

            .active-img {
                width: 100%;
                height: 500px;
                padding: 20px 20px 0 20px;
            }

            .test {
                background-color: var(--light-color)
            }

            section {
                background-color: var(--darkest-color);
                height: 525px;
                
                
            }

            .vote-section {
                background-color: var(--darker-color);
                height: 50px;
            }

            #votes-to-skip {
                margin-left: 20px;
                color: white;
                width: 100px;
            }
            
            /* #votes-to-skip-count {
                margin-left: 50px;
                margin-bottom: 0;
                color: white;
                width: 100px;
                font-weight: 700;
            }

            .votes-to-skip-text {
                margin-left: 20px;
                margin-bottom: 0;
                color: white;
                width: 100px;
                font-size: 14px;
            } */

            #search {
                width: 25%;
                height: 30px;
                border-radius: 10px;
                /* padding: 10px; */
                margin:10px;
            }

            .media-controls {
                background-color: var(--darker-color);
                height: 50px;
            }

            /* Change the thumb of the range slider input to black. */
            .slider {
                -webkit-appearance: none;
                width: 100%;
                height: 5px;
                background: rgba(10,10,10);
                outline: none;
                opacity: 0.7;
                -webkit-transition: .2s;
                transition: opacity .2s;
                border-radius: 10%;
            }


            .slider::-webkit-slider-thumb {
                -webkit-appearance: none;
                appearance: none;
                width: 10px;
                height: 10px;
                background: #17a2b8;
                border-radius: 50%;
                cursor: pointer;
            }


            label {
                margin-left: 20px;
            }

            .settings-textinput {
                width: 200px;
                display: inline;
                margin-left: 5px;
                font-size:20px;
            }

            .text-lime {
                color: #aeea00;
            }
        </style>
    </head>
    <body>
        <div class="container-fluid p-0" style="overflow: hidden">
            <div class="row">
                <div class="col-12">
                    <div id="header" class="border-bottom border-info">
                        <p class="text-center m-0">JukeBox</p>
                    </div>
                </div>
            </div>

     
            
            <div class="row">
                    <div class="col-3 border-right border-info pr-0">
                        <nav>
                            <ul class="nav flex-column test">
                                <li class="nav-item ">
                                    <a class="nav-link" href="#" id="active-btn">
                                        <i class="bi bi-music-note nav-icon"></i>Active
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#"  id="queue-btn">
                                        <i class="bi bi-list-ul nav-icon"></i>Queue
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#"  id="all-btn">
                                        <i class="bi bi-file-earmark-music-fill nav-icon"></i>All Songs
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#"  id="settings-btn">
                                        <i class="bi bi-gear-fill nav-icon"></i>Settings
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="#"  id="logs-btn">
                                        <i class="bi bi-file-earmark-text nav-icon"></i>Logs
                                    </a>
                                </li>
                            </ul>
                        </nav>

                         
                    </div>
                  
                    
                <div class="col-9 pl-0">
                    <section id="active-section">
                        <img id="active-song-image" class="img-fluid active-img" src="https://cdn.cloudflare.steamstatic.com/steamcommunity/public/images/avatars/fe/fef49e7fa7e1997310d705b2a6158ff8dc1cdfeb_full.jpg" alt="">
                        <p id="active-song-text" class="text-center">! No song active !</p>
                    </section>

                    <section id="queue-section" style="display: none;  padding-top: 0; overflow: scroll">

                        <table class="table">
                            <thead style="border-top: none;">
                              <tr>
                                <th scope="col">Thumbnail</th>
                                <th scope="col">Name</th>
                                <th scope="col">Duration</th>
                                <th scope="col">Requester</th>
                                <th scope="col">Actions</th>
                              </tr>
                            </thead>
                            <tbody>
                             
                            </tbody>
                          </table>
                    </section>

                    <section id="all-section" style="display: none;  padding-top: 0; overflow: scroll">

                        <table class="table">
                            <thead style="border-top: none;">
                              <tr>
                                <th scope="col">Thumbnail</th>
                                <th scope="col">Name</th>
                                <th scope="col">Duration</th>
                                <th scope="col">Requester</th>
                                <th scope="col">Actions</th>
                              </tr>
                            </thead>
                            <tbody>
                             
                              
                            </tbody>
                          </table>
                    </section>   


                    <section id="settings-section" style="display: none;  padding-top: 0; overflow: scroll">
                        <!-- Create an input text field with bootstrap classes. -->
                        <label for="jukebox-listener-count">JukeBox Listener</label>
                        <!-- Create an input and make sure it always start with "!". -->
                        <input type="text" class="form-control settings-textinput pl-0 pr-0" style="width: 20px; border-radius: 0; border-bottom-left-radius: 0.25rem; border-top-left-radius: 0.25rem; padding: 0.375rem 0.75rem;" value="!" readonly /><input type="text" class="form-control settings-textinput" id="jukebox-listener" style="margin-left:0;border-top-left-radius: 0;border-bottom-left-radius: 0; padding-left:0" value="!jukebox">
                        
                    </section>
                    <section id="logs-section" style="display: none;  padding-top: 0; overflow: scroll">
                        <table class="table">
                            <thead style="border-top: none;">
                              <tr>
                                <th scope="col">Code</th>
                                <th scope="col">Message</th>
                                <th scope="col">Date</th>
                              </tr>
                            </thead>
                            <tbody>

                            </tbody>
                          </table>
                    
                    </section>
                </div> 

            </div>

            <div class="row">
                <div class="col-3 pr-0">
                    <div class="vote-section border-top border-info">
                        <p id="votes-to-skip-count" class="text-center mb-0">0/3</p>
                        <p class="text-center">VOTES TO SKIP</p>
                    </div>
                </div>

                <div class="col-9 pl-0">
                    <div class="media-controls border-top border-info">
                        <div class="row">
                            <div class="col-2 pr-0">
                                <p class="text-center" id="seconds-into-song">0:00</p>                        
                            </div>
                            <div class="col-8">
                                <input type="range" class="slider"  id="song-progress" min="0" max="100" value="0" step=0.1 style="width: 100%; pointer-events: none;">
                            </div>
                            <div class="col-2">
                                <p class="text-center" id="total-song-length">0:00</p>
                            </div>
                        </div>                   
                    </div>
                </div>
            </div>
            
        </div>
        
        
        <script>

             const sections = ["active", "queue", "all", "settings", "logs"];
            for (let i=0; i<sections.length;i++){
                const section = document.getElementById(sections[i]+"-section");
                const btn = document.getElementById(sections[i]+"-btn");
                
                btn.addEventListener('click', () => {
                    for (let i=0; i<sections.length;i++){
                        const section = document.getElementById(sections[i]+"-section");
                        const btn = document.getElementById(sections[i]+"-btn");
                        console.log(section, sections[i]);
                        section.style.display = 'none';
                        btn.style.backgroundColor = '';
                        btn.style.color = '#ffffff';
                    }
                    section.style.display = 'block';
                    btn.style.backgroundColor = 'rgba(27, 27,27, 0.7)';
                    btn.style.color = '#ffc107';
                });
            }
            
            document.getElementById("all-btn").click()


            // Protect the string from XSS.
            function escapeHtml(unsafe) {
                return unsafe
                    .replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;")
                    .replace(/"/g, "&quot;")
                    .replace(/'/g, "&#039;");
            }

            // Seconds into minutes and seconds format.
            const secondsToMinutesAndSeconds = (seconds) => {
                const minutes = Math.floor(seconds / 60);
                const secondsLeft = seconds % 60;
                return `${minutes}:${secondsLeft < 10 ? '0' : ''}${secondsLeft}`;
            }

            const addSongToQueue = (image, name, duration, requester, id) => {
                const table = document.querySelector('#queue-section table tbody');
                const tr = document.createElement('tr');
                const td1 = document.createElement('td');
                const td2 = document.createElement('td');
                const td3 = document.createElement('td');
                const td4 = document.createElement('td');
                const td5 = document.createElement('td');
                const td6 = document.createElement('td');

                const img = document.createElement('img');
                img.src = image;
                img.className = 'img-fluid';
                img.width = 100;
                img.height = 100;

                tr.setAttribute('id', id);
                
                name = escapeHtml(name);
                requester = escapeHtml(requester);
                
                td1.innerHTML = `<img class="img-fluid" src="${image}" width=100 height=100>`;
                td2.innerHTML = `<td class="song-name"><p style="width: 180px; text-overflow: ellipsis; overflow:hidden;">${name}</p></td>`;
                td3.innerHTML = `<td>${secondsToMinutesAndSeconds(duration)}</td>`;
                td4.innerHTML = `<td>${requester}</td>`;
                td5.innerHTML = `<td style="white-space: nowrap">
                                    <button style="font-size: 13px;" class="btn btn-warning btn-sm text-dark" onclick="alert('skip_' + '${id}')">Skip >></button>
                                </td>`;
                
               


                tr.appendChild(td1);
                tr.appendChild(td2);
                tr.appendChild(td3);
                tr.appendChild(td4);
                tr.appendChild(td5);
                

                table.appendChild(tr);

            }

            const addSongToAll = (image, name, duration, requester, id) => {
                const table = document.querySelector('#all-section table tbody');
                const tr = document.createElement('tr');
                const td1 = document.createElement('td');
                const td2 = document.createElement('td');
                const td3 = document.createElement('td');
                const td4 = document.createElement('td');
                const td5 = document.createElement('td');
                const td6 = document.createElement('td');

                const img = document.createElement('img');
                img.src = image;
                img.className = 'img-fluid';
                img.width = 100;
                img.height = 100;

                tr.setAttribute('id', id);
                
                name = escapeHtml(name);
                requester = escapeHtml(requester);
                
                td1.innerHTML = `<img class="img-fluid" src="${image}" width=100 height=100>`;
                td2.innerHTML = `<td class="song-name"><p style="width: 175px; word-wrap: break-word;">${name}</p></td>`;
                td3.innerHTML = `<td>${secondsToMinutesAndSeconds(duration)}</td>`;
                td4.innerHTML = `<td><p style="width: 90px; word-wrap: break-word;">${requester}</p></td>`;
                td5.innerHTML = `<td style="white-space: nowrap">
                <button style="font-size: 13px;" class="btn btn-success btn-sm text-white" onclick="alert('queue_' + '${id}')">Queue</button>
                <button style="font-size: 13px;" class="btn btn-danger btn-sm text-white" onclick="alert('delete_' + '${id}')">Delete</button>
                                </td>`;
                
               


                tr.appendChild(td1);
                tr.appendChild(td2);
                tr.appendChild(td3);
                tr.appendChild(td4);
                tr.appendChild(td5);
                

                table.appendChild(tr);

            }

            // Remove song from all.
            const removeSongFromAll = (id) => {
                const table = document.querySelector('#all-section table tbody');
                const tr = document.getElementById(id);
                table.removeChild(tr);
            }


            removeSongFromQueue = (id) => {
                const table = document.querySelector('#queue-section table tbody');
                const tr = document.getElementById(id);
                table.removeChild(tr);
            }

            const setTotalSongLength = (seconds) => {
                const slider = document.getElementById('song-progress');
                slider.value = 0;
                const totalSongLength = document.getElementById('total-song-length');
                totalSongLength.innerHTML = secondsToMinutesAndSeconds(seconds);
                slider.max = seconds;
            }

            const setSecondsIntoSong = (seconds) => {
                const secondsIntoSong = document.getElementById('seconds-into-song');

                // Display a rounded amount.
               


                secondsIntoSong.innerHTML = secondsToMinutesAndSeconds(Math.round(seconds));
                const slider = document.getElementById('song-progress');
                slider.value = seconds;
;
            }

            // Create a function that removes a song from the queue.
           
            const setActiveSong = (name, image) => {
                const activeSongText = document.getElementById('active-song-text');
                const activeSongImage = document.getElementById('active-song-image');
                activeSongText.innerHTML = name;
                activeSongImage.src = image;
            }


            const addLog = (error_code, message, date, type) => {
                const log = document.querySelector('#logs-section table tbody');
                const tr = document.createElement('tr');
                const td1 = document.createElement('td');
                const td2 = document.createElement('td');
                const td3 = document.createElement('td');

                td1.innerHTML = `<td><p>${error_code}</p></td>`;
                td2.innerHTML = `<td><p style="width: 250px; word-wrap: break-word;">${message}</p></td>`;
                td3.innerHTML = `<td><p>${date}</p></td>`;
                      

                if (type === 'success') {
                    tr.style.backgroundColor = 'rgba(15, 65, 27, 1)';
                } else if (type === 'warning') {
                    tr.style.backgroundColor = 'rgba(100, 75, 0, 1)';
                } else {
                    tr.style.backgroundColor = 'rgba(86, 20, 27, 1)';
                }

                // Add the p-0 class onto the tds.
                td1.className = 'p-0';
                td2.className = 'p-0';
                td3.className = 'p-0';


                tr.appendChild(td1);
                tr.appendChild(td2);
                tr.appendChild(td3);

                log.appendChild(tr);               
            }

            
      

        </script>

    </body>
</html>

